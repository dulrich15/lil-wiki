{% extends "wiki/base.html" %}
{% load rst_tags %}

{% block extra-script %}
$(document).keydown(function(e) {
    var keycode = e.which || e.keyCode;
    var key = String.fromCharCode(keycode).toLowerCase()

    {% if user.is_staff %}
    if (key == 'e' && e.ctrlKey)
    {
        location.href='{% url wiki_edit page.title %}';
        e.preventDefault();
    }
    {% endif %}
});    
{% endblock %}

{% block main-content %}
<div{% if user.is_staff %} ondblclick="location.href='{% url wiki_edit page.title %}';"{% endif %}>
    <h1 id="title">{{ page.title }}</h1>
    <div id="content">
    {{ page.content|rst2html }}
    </div>
</div>
    
<div id="related-pages">
    <h2>Related Pages</h2>
    <p>Up to&hellip;</p>
    <ul>
        <li>{{ page.parent }}</li>
    </ul>
    <p>Down to&hellip;</p>
    <ul>
        {% for child in page.children %}
        <li>{{ child }}</li>
        {% endfor %}
    </ul>
    <p>Sideways&hellip;</p>
    <ul>
        {% for sibling in page.siblings %}
        <li>{{ sibling }}</li>
        {% endfor %}
    </ul>
</div>

<div id="controls">
    <h2>Page Controls</h2>
    <ul id="control_list">
        {% if user.is_staff %}
        <li><a href="{% url wiki_logout %}?next={% url wiki_show page.pg %}">Logout</a></li>
        {% else %}
        <li><a href="{% url wiki_login %}?next={% url wiki_show page.pg %}">Login</a></li>
        {% endif %}
        <li><a href="{% url wiki_root %}">WikiRoot</a></li>
        {% if user.is_staff %}
        <li><a href="{% url wiki_edit page.title %}">Edit Page</a></li>
        {% endif %}
    </ul>
</div>

{% include "website/mathjax.html" %}
{% endblock %}
