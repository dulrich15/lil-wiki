{% extends "wiki/base.html" %}
{% load rst_tags %}

{% block html-head %}
	<link rel="stylesheet" href="{{ STATIC_URL }}wiki/css/main.css" media="screen" />
	<link rel="stylesheet" href="{{ STATIC_URL }}wiki/css/print.css" media="print" />

    <script src="{{ STATIC_URL }}wiki/js/jquery-1.8.3.min.js"></script>
    <script src="{{ STATIC_URL }}wiki/js/main.js"></script>

    <script>
    $(document).keydown(function(e) {
        var keycode = e.which || e.keyCode;
        var key = String.fromCharCode(keycode).toLowerCase()

        {% if user.is_staff %}
        if (key == 'e' && e.ctrlKey)
        {
            location.href='{% url wiki_edit page.title %}';
            e.preventDefault();
        }
        {% endif %}
        if ( keycode == 27 ) // escape
        {
            e.preventDefault();
            var elem = document.getElementById("control_list").style;
            elem.display = ( elem.display != 'none' ) ? 'none' : 'block';
        }
    });    
    </script>
{% endblock %}

{% block main-content %}
<div{% if user.is_staff %} ondblclick="location.href='{% url wiki_edit page.title %}';"{% endif %}>
<h1 id="title">{{ page.title }}</h1>
<div id="content">
{{ page.content|rst2html }}
</div>
</div>

<div id="controls">
    <h2>Page Controls</h2>
    <ul id="control_list">
        {% if user.is_staff %}
        <li><a href="{% url wiki_edit page.title %}">Edit Page</a></li>
        {% endif %}
        <li><a href="{% url wiki_root %}">WikiRoot</a></li>
    </ul>
</div>

{% include "website/mathjax.html" %}
{% endblock %}
